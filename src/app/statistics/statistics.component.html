<div class="statistics">
  <app-date-filter (changeDateFrameEvent)="onFilterChange()"></app-date-filter>
  <div class="statistics-title" *ngIf="currentDateFrame | async as currentDate">
    Период:
    <span class="statistic-date-frame">{{ currentDate?.display }}</span>
    <span
      style="color: grey"
      *ngIf="
        currentDate?.display === initialDayFrameLabel ||
        currentDate?.display === initialWeekFrameLabel ||
        currentDate?.display === initialMonthFrameLabel
      "
    >
      ({{ currentDay }})</span
    >
    <i
      (click)="onRefreshDateFilter()"
      *ngIf="currentDate?.display !== initialDayFrameLabel"
      class="fas fa-redo-alt statistic-refresh-button"
    ></i>
    <br />
  </div>
  <hr class="statistics-separator" />
  <div style="width: 100%; height: 200px">
    <div id="donut-chart" style="width: 100%; height: 100%"></div>
  </div>
  <hr class="statistics-separator" />
  <span class="statistic-category-label">
    Категории:
    <span *ngIf="excludedCategories?.length > 0">
      (За исключением
      <span class="statistic-excluded-category">{{
        excludedCategories | categoryListName
      }}</span
      >)
      <i
        (click)="onRefresh()"
        class="fas fa-redo-alt statistic-refresh-button"
      ></i>
    </span>
  </span>
  <span class="statistics-checkbox">
    <input
      type="checkbox"
      value="regular"
      id="category-regular"
      class="statistics-checkbox-input"
      [checked]="true"
      [(ngModel)]="irregularCategoriesCheckboxValue"
      (ngModelChange)="onRegularCategoriesCheckboxClick($event)"
    />
    <label for="category-regular">Регулярное <span style="color: grey;">({{ regularAmount }}€)</span></label>
    <input
      type="checkbox"
      value="irregular"
      id="category-irregular"
      class="statistics-checkbox-input"
      [checked]="true"
      [(ngModel)]="regularCategoriesCheckboxValue"
      (ngModelChange)="onIrregularCategoriesCheckboxClick($event)"
    />
    <label for="category-irregular">Нерегулярное <span style="color: grey;">({{ irregularAmount }}€)</span></label>
  </span>
  <app-statistics-bar
    *ngFor="let categoryTotal of categoryTotals"
    [amount]="categoryTotal.amount"
    [category]="categoryTotal.category"
    [percentage]="categoryTotal.percentage"
    (close)="onBarClose($event)"
  >
  </app-statistics-bar>
  <hr class="statistics-separator" />
  <div style="display: block">
    <canvas
      baseChart
      [datasets]="chartOptions.datasets"
      [labels]="chartOptions.labels"
      [options]="chartOptions.options"
      [legend]="chartOptions.legend"
      type="bar"
    >
    </canvas>
  </div>
</div>
